<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CSV Data Viewer</title>
</head>
<body>
    <label for="categoryFilter">Filter by category:</label>
    <select id="categoryFilter" onchange="filterData()">
        <option value="">Select a category</option>
        {% for category in categories %}
        <option value="{{ category }}">{{ category }}</option>
        {% endfor %}
    </select>

    <div id="dataDisplay"></div>

    <script>
        function filterData() {
            const category = document.getElementById('categoryFilter').value;
            fetch(`/data?category=${category}`)
                .then(response => response.json())
                .then(data => {
                    const display = document.getElementById('dataDisplay');
                    if (data && data.length > 0) {
                        // Ensure data is displayed as a list
                        display.innerHTML = '<ul>' + data.map(item => `<li>${item.location_link} - ${item.category}</li>`).join('') + '</ul>';
                    } else {
                        // Handle case where no data is returned for the selected category
                        display.innerHTML = '<p>No data found for this category.</p>';
                    }
                }).catch(error => {
                    console.error('Error fetching data:', error);
                    document.getElementById('dataDisplay').innerHTML = '<p>Error fetching data. Please try again later.</p>';
                });
        }
    </script>
</body>
</html>
